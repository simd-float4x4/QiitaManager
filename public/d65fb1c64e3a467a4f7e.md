---
title: 【Swift】Bool.toggle()をUserDefaults.setValueにぶち込もうとして怒られた
tags:
  - SwiftUI
private: false
updated_at: '2025-10-28T22:44:24+09:00'
id: d65fb1c64e3a467a4f7e
organization_url_name: null
slide: false
ignorePublish: false
---
### 発生した課題
* `bool.toggle()`を`UserDefaults.setValue`にぶっこもうとしたらエラーが発生した。

```Swift
var newValue = currentBool
UserDefaults.standard.set(newValue.toggle(), forKey: "isShakingEnabled")
```

### 発生したエラー

::: note alert
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Attempt to insert non-property list object () for key isShakingEnabled'
*** First throw call stack:
(0x19dda68c8 ... 
... 0x104da15e8 0x19ad72e28)
libc++abi: terminating due to uncaught exception of type NSException
:::

### ツッコミどころ1
* `Bool`型に`toggle()`したものをぶっ込んだけど`import Foundation`されてないから使えない

### ツッコミどころ2
* そもそも`Toggle`は押下した時点でバインディングの変数を自動的に`toggle`してくれるから書く必要がない

### ツッコミどころ3
* `@AppStorage`を使えば`UserDefaults`ライクなことを勝手にしてくれる


### 解決策（一例）
```Swift
// 別画面に同じ値を使う処理を作りたい時はAppStorageを使って使い回す

@AppStorage("isShakingEnabled") private var isShakingEnabled: Bool = true 

var body: some View {
    Toggle(isOn: $isShakingEnabled, label: { Text("シェイクを有効にする") })
}

.onLongPressGesture(minimumDuration: 0, pressing: { pressing in
    if isShakingEnabled && pressing {
        hapticAndSound()
    }
}, perform: {})
```
